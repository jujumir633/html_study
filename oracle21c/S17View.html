<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>가상테이블 View(뷰)</title>
</head>
<body>
    <h1>가상테이블 View(뷰)</h1>
    <section>
        <h2>1. View(뷰)의 개념</h2>
        <ul>
            <li>View는 <strong>SELECT 결과를 이름 붙여 저장한 가상의 테이블</strong>이다.</li>
            <li>실제 데이터를 저장하지 않고 <strong>정의(쿼리)</strong>만 저장한다.</li>
            <li>조회 시 뷰 내부의 SELECT 문이 실행되어 결과를 반환한다.</li>
        </ul>
    </section>


    <section>
        <h2>2. View의 장점</h2>
        <ul>
            <li><strong>복잡한 쿼리 단순화</strong>: 조인·서브쿼리 등을 한 번 정의해 두면 간단히 조회 가능</li>
            <li><strong>재사용성</strong>: 여러 쿼리에서 같은 로직을 반복하지 않아도 된다</li>
            <li><strong>보안/권한 제어</strong>: 특정 컬럼·조건만 노출하거나 테이블 직접 접근을 막을 수 있다</li>
            <li><strong>논리적 독립성</strong>: 테이블 구조가 바뀌어도 응용 프로그램 쿼리를 그대로 유지 가능</li>
            <li><strong>코드 가독성 향상</strong>: SQL을 캡슐화해 유지보수와 협업이 쉬워진다</li>
        </ul>
    </section>


    <section>
        <h2>3. View의 한계와 주의점</h2>
        <ul>
            <li><strong>성능 향상 효과 없음</strong>: 일반 View는 데이터를 저장하지 않으며 실행 때마다 내부 SELECT를 다시 수행한다.</li>
            <li>복잡한 뷰를 중첩하면 오히려 옵티마이저 최적화가 어려워져 성능이 저하될 수 있다.</li>
            <li><strong>데이터 변경(DML) 가능 여부</strong>:
                <ul>
                    <li>단일 테이블 기반 단순 뷰는 <code>INSERT / UPDATE / DELETE</code> 가능하며 실제 테이블 데이터가 수정된다.</li>
                    <li>하지만 실무에서는 데이터 무결성 때문에 대부분 조회용으로만 사용하며, 필요 시 <code>WITH READ ONLY</code> 옵션으로 변경을 막는다.</li>
                    <li>조인/집계/복잡한 뷰는 기본적으로 DML이 불가능하다.</li>
                </ul>
            </li>
        </ul>
    </section>


    <section>
        <h2>4. View 생성/수정/삭제 문법</h2>
        <pre><code>-- 생성
CREATE VIEW 뷰이름 AS
SELECT 컬럼1, 컬럼2 ...
FROM 테이블
WHERE 조건;


– 수정(기존 정의 대체)
CREATE OR REPLACE VIEW 뷰이름 AS
SELECT …

– 읽기 전용 옵션
CREATE OR REPLACE VIEW 뷰이름 AS
SELECT …
WITH READ ONLY;

– 삭제
DROP VIEW 뷰이름;
        </code></pre>
    </section>


    <section>
        <h2>5. 실습 예제</h2>
        <pre><code>-- 1. 단일 테이블 뷰 (급여와 부서만 노출)
CREATE OR REPLACE VIEW emp_simple_v AS
SELECT empno, ename, sal, deptno
FROM emp;


SELECT * FROM emp_simple_v;
UPDATE emp_simple_v SET sal = sal + 100 WHERE empno = 7369; – 실제 EMP 수정됨

– 2. 조인 뷰 (부서명과 함께 사원 조회)
CREATE OR REPLACE VIEW emp_dept_v AS
SELECT e.empno, e.ename, e.sal, d.dname, d.loc
FROM emp e
JOIN dept d ON e.deptno = d.deptno;

SELECT * FROM emp_dept_v; – 조인 쿼리 대신 간단히 조회
UPDATE emp_dept_v SET sal = sal + 100 WHERE empno = 7369; – 오류 (조인 뷰는 DML 불가)

– 3. 읽기 전용 강제
CREATE OR REPLACE VIEW emp_readonly_v AS
SELECT empno, ename, sal FROM emp
WITH READ ONLY;

UPDATE emp_readonly_v SET sal = sal + 100 WHERE empno = 7369; – ORA-42399 오류
        </code></pre>
    </section>


    <section>
        <h2>6. 정리</h2>
        <ul>
            <li>View는 <strong>쿼리를 단순화·재사용·보안 강화·독립성 유지</strong>를 위해 사용한다.</li>
            <li>일반 View는 데이터를 저장하지 않으며 <strong>성능 이점은 없다.</strong></li>
            <li>단일 테이블 뷰는 DML(수정/삭제/등록)이 가능하지만 <strong>실무에서는 안정성을 위해 대부분 읽기 전용으로 사용</strong>한다.</li>
            <li>복잡한 조인 뷰는 기본적으로 DML이 불가능하다.</li>
            <li>성능 향상이 필요하면 일반 View가 아닌 <strong>Materialized View</strong>를 고려해야 한다.</li>
        </ul>
    </section>

</body>
</html>