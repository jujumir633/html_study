<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Order By 정렬</title>
    <link rel="stylesheet" href="/src/css/study.css">
</head>
<body>
    <h1>Order By 정렬</h1>
    <section>
        <h2>정렬 (ORDER BY)</h2>
        <ul>
            <li><code>ORDER BY</code> 절은 SELECT 문의 결과를 특정 기준에 따라 정렬할 때 사용한다</li>
            <li>정렬은 오름차순(ASC)과 내림차순(DESC)으로 지정할 수 있다</li>
            <li>명시하지 않으면 기본값은 오름차순(ASC)이다</li>
        </ul>

        <h3>(1) 기본 정렬</h3>
        <ul>
            <li><strong>오름차순 정렬 (ASC)</strong>: 작은 값 → 큰 값, 알파벳 순, 과거 → 미래</li>
            <li><strong>내림차순 정렬 (DESC)</strong>: 큰 값 → 작은 값, 알파벳 역순, 미래 → 과거</li>
        </ul>
        <pre><code>-- 급여를 오름차순으로 정렬
SELECT ename, sal
FROM emp
ORDER BY sal ASC;

-- 급여를 내림차순으로 정렬
SELECT ename, sal
FROM emp
ORDER BY sal DESC;</code></pre>

        <h3>(2) 여러 컬럼 정렬</h3>
        <ul>
            <li>ORDER BY 절에는 여러 컬럼을 지정할 수 있다</li>
            <li>앞의 컬럼 기준으로 먼저 정렬하고, 값이 같을 경우 다음 컬럼 기준으로 정렬한다</li>
        </ul>
        <pre><code>-- 부서번호(deptno) 오름차순, 같은 부서에서는 급여 내림차순
SELECT deptno, ename, sal
FROM emp
ORDER BY deptno ASC, sal DESC;</code></pre>

        <h3>(3) 컬럼 번호로 정렬</h3>
        <ul>
            <li>SELECT 절의 출력 순서를 기준으로 번호를 지정할 수도 있다</li>
            <li>실무에서는 가독성이 떨어지므로 컬럼명을 직접 쓰는 것이 권장된다</li>
        </ul>
        <pre><code>-- SELECT 절의 두 번째 컬럼(sal)을 기준으로 내림차순
SELECT ename, sal
FROM emp
ORDER BY 2 DESC;</code></pre>

        <h3>(4) 함수와 함께 정렬</h3>
        <ul>
            <li>정렬 기준을 함수 결과로 지정할 수도 있다</li>
        </ul>
        <pre><code>-- 이름을 대문자로 변환한 결과를 기준으로 정렬
SELECT ename
FROM emp
ORDER BY UPPER(ename);</code></pre>

        <h3>(5) NULL 처리</h3>
        <ul>
            <li>NULL 값은 기본적으로 오름차순에서는 마지막, 내림차순에서는 처음에 온다</li>
            <li><code>NULLS FIRST</code>, <code>NULLS LAST</code> 옵션으로 위치를 지정할 수 있다</li>
        </ul>
        <pre><code>-- 보너스(comm)를 내림차순 정렬, NULL은 마지막에 위치
SELECT ename, comm
FROM emp
ORDER BY comm DESC NULLS LAST;</code></pre>
    </section>

    <section>
        <h2>정렬의 기술적 처리</h2>
        <ul>
            <li><code>ORDER BY</code>는 SQL 실행 순서상 <strong>마지막 단계</strong>에서 수행된다</li>
            <li>즉, FROM → WHERE → GROUP BY → HAVING → SELECT 까지 모든 조회가 끝난 후, 최종 결과 집합을 대상으로 정렬이 적용된다</li>
            <li>정렬 과정에서는 결과 집합을 임시 테이블(Temporary Segment)에 저장하고, 이를 기반으로 순서를 재배치한다</li>
            <li>이 때문에 <code>ORDER BY</code>는 항상 SELECT 문에서 <strong>마지막</strong>에 위치한다</li>
            <li>정렬은 메모리(SORT_AREA) 또는 디스크 TEMP 테이블스페이스를 사용하므로 데이터가 많을수록 성능에 큰 영향을 준다</li>
        </ul>

        <h3>SQL 처리 순서</h3>
        <pre><code>1. FROM      -- 테이블, 뷰 결합
2. WHERE     -- 행 단위 조건 필터링
3. GROUP BY  -- 그룹화
4. HAVING    -- 그룹 조건 필터링
5. SELECT    -- 컬럼 선택, 계산, 함수 실행
6. ORDER BY  -- 최종 결과 정렬
</code></pre>

    </section>
    <section>
        <h2>ORDER BY 연습 문제</h2>
        <ol>
            <li>사원 이름(ename)을 오름차순으로 정렬하여 출력하라.</li>
            <li>급여(sal)를 내림차순으로 정렬하여 출력하라.</li>
            <li>입사일(hiredate)을 오름차순으로 정렬하여 가장 먼저 입사한 사원이 위에 오도록 하라.</li>
            <li>부서번호(deptno)를 오름차순으로 정렬하고, 같은 부서에서는 급여(sal)를 내림차순으로 정렬하라.</li>
            <li>직무(job)를 오름차순으로 정렬하고, 같은 직무에서는 이름(ename)을 오름차순으로 정렬하라.</li>
            <li>급여(sal)를 기준으로 정렬하되, 같은 급여인 경우 입사일(hiredate)이 빠른 순으로 정렬하라.</li>
            <li>SELECT 절의 두 번째 컬럼(sal)을 기준으로 내림차순 정렬하라.</li>
            <li>사원 이름(ename)을 대문자로 변환한 결과를 기준으로 오름차순 정렬하라.</li>
            <li>보너스(comm)를 오름차순 정렬하되, NULL 값이 있는 경우 항상 마지막에 오도록 하라.</li>
            <li>부서번호(deptno)를 내림차순으로 정렬하고, 같은 부서 내에서는 직무(job)를 오름차순으로 정렬하라.</li>
        </ol>
    </section>
    <section>
        <h2>ORDER BY 정답</h2>
        <ol>
            <li>
      <pre><code>SELECT ename
FROM emp
ORDER BY ename ASC;</code></pre>
            </li>

            <li>
      <pre><code>SELECT ename, sal
FROM emp
ORDER BY sal DESC;</code></pre>
            </li>

            <li>
      <pre><code>SELECT ename, hiredate
FROM emp
ORDER BY hiredate ASC;</code></pre>
            </li>

            <li>
      <pre><code>SELECT deptno, ename, sal
FROM emp
ORDER BY deptno ASC, sal DESC;</code></pre>
            </li>

            <li>
      <pre><code>SELECT job, ename
FROM emp
ORDER BY job ASC, ename ASC;</code></pre>
            </li>

            <li>
      <pre><code>SELECT ename, sal, hiredate
FROM emp
ORDER BY sal ASC, hiredate ASC;</code></pre>
            </li>

            <li>
      <pre><code>SELECT ename, sal
FROM emp
ORDER BY 2 DESC;  -- sal 컬럼 기준</code></pre>
            </li>

            <li>
      <pre><code>SELECT ename
FROM emp
ORDER BY UPPER(ename) ASC;</code></pre>
            </li>

            <li>
      <pre><code>SELECT ename, comm
FROM emp
ORDER BY comm ASC NULLS LAST;</code></pre>
            </li>

            <li>
      <pre><code>SELECT deptno, job, ename
FROM emp
ORDER BY deptno DESC, job ASC;</code></pre>
            </li>
        </ol>
    </section>
</body>
</html>