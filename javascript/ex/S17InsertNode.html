<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>노드 수정 및 삽입</title>
    <link rel="stylesheet" href="/src/css/study.css">
</head>
<body>
    <h1>노드 수정 및 삽입</h1>
    <section>
        <h2>1. innerHTML 방식</h2>
        <ul>
            <li><code>element.innerHTML = "&lt;div&gt;추가&lt;/div&gt;"</code> : 문자열을 HTML로 해석하여 자식 전체를 교체</li>
            <li><code>element.innerHTML += "..."</code> : 기존 내용 뒤에 새로운 HTML을 추가</li>
            <li>장점: 빠르고 간단하게 여러 요소를 한 번에 삽입 가능</li>
            <li>단점: DOM 전체를 다시 해석하므로 성능 저하, 기존 이벤트 핸들러가 사라질 수 있음</li>
        </ul>
    </section>

    <section>
        <h2>2. DOM 메서드 방식</h2>
        <ul>
            <li><code>document.createElement("div")</code> : 요소 노드 생성</li>
            <li><code>document.createTextNode("텍스트")</code> : 텍스트 노드 생성</li>
            <li><code>parent.appendChild(node)</code> : 부모의 맨 뒤에 추가</li>
            <li>장점: 이벤트 핸들러 유지, 보안에 안전</li>
            <li>단점: 코드가 다소 길어짐</li>
        </ul>
    </section>

    <section>
        <h2>3. 삽입 위치 지정 (최신 메서드)</h2>
        <ul>
            <li><code>append(...nodes)</code> : 부모의 맨 뒤에 삽입</li>
            <li><code>prepend(...nodes)</code> : 부모의 맨 앞에 삽입</li>
            <li><code>before(...nodes)</code> : 대상 요소 앞에 삽입</li>
            <li><code>after(...nodes)</code> : 대상 요소 뒤에 삽입</li>
            <li><code>replaceWith(...nodes)</code> : 대상 요소 교체</li>
            <li><code>remove()</code> : 요소 제거</li>
        </ul>
        <style>
            .container {
                border: 2px solid #333;
                padding: 1em;
                margin-top: 1em;
                width: 320px;
            }
            .item {
                background: lightblue;
                margin: 0.3em 0;
                padding: 0.5em;
                border-radius: 4px;
            }
            button {
                margin: 0.2em;
            }
        </style>
        <h2>3. 삽입 위치 지정 (최신 메서드)</h2>
        <p>버튼을 눌러 각 메서드의 동작을 확인하세요.</p>

        <div>
            <button id="btnAppend">append()</button>
            <button id="btnPrepend">prepend()</button>
            <button id="btnBefore">before()</button>
            <button id="btnAfter">after()</button>
            <button id="btnReplace">replaceWith()</button>
            <button id="btnRemove">remove()</button>
        </div>

        <div id="container" class="container">
            <div class="item target">기준 아이템(Target)</div>
        </div>

        <script>
            const container = document.querySelector("#container");
            const target = container.querySelector(".target");

            // 새 아이템 만드는 함수
            const makeItem = (text) => {
                const div = document.createElement("div");
                div.className = "item";
                div.textContent = text;
                return div;
            };

            document.querySelector("#btnAppend").onclick = () => {
                container.append(makeItem("append로 추가된 아이템"));
            };

            document.querySelector("#btnPrepend").onclick = () => {
                container.prepend(makeItem("prepend로 추가된 아이템"));
            };

            document.querySelector("#btnBefore").onclick = () => {
                target.before(makeItem("before로 추가된 아이템"));
            };

            document.querySelector("#btnAfter").onclick = () => {
                target.after(makeItem("after로 추가된 아이템"));
            };

            document.querySelector("#btnReplace").onclick = () => {
                target.replaceWith(makeItem("replaceWith로 교체된 아이템"));
            };

            document.querySelector("#btnRemove").onclick = () => {
                target.remove();
            };
        </script>

    </section>

    <section>
        <h2>4. 전통적 메서드 vs 최신 메서드</h2>
        <ul>
            <li><code>appendChild(node)</code> ≈ <code>append(...nodes)</code></li>
            <li><code>insertBefore(new, ref)</code> ≈ <code>before(...nodes)</code>, <code>prepend(...nodes)</code></li>
            <li><code>replaceChild(new, old)</code> ≈ <code>replaceWith(...nodes)</code></li>
            <li><code>removeChild(node)</code> ≈ <code>remove()</code></li>
            <li>최신 메서드는 문자열도 허용하고, 여러 노드를 동시에 처리 가능</li>
        </ul>
    </section>

    <section>
        <h2>5. insertAdjacentHTML / insertAdjacentText</h2>
        <ul>
            <li><code>elem.insertAdjacentHTML("beforebegin", "&lt;div&gt;...&lt;/div&gt;")</code></li>
            <li>위치 옵션: beforebegin, afterbegin, beforeend, afterend</li>
            <li>innerHTML보다 부분 삽입에 적합, 기존 노드를 유지</li>
            <li><code>insertAdjacentText</code> : HTML 해석 없이 텍스트 그대로 삽입</li>
        </ul>
        <h2>insertAdjacentHTML / insertAdjacentText 실습</h2>
        <p>버튼을 눌러 각 위치 옵션과 차이를 확인하세요.</p>

        <div>
            <button onclick="addHTML('beforebegin')">beforebegin</button>
            <button onclick="addHTML('afterbegin')">afterbegin</button>
            <button onclick="addHTML('beforeend')">beforeend</button>
            <button onclick="addHTML('afterend')">afterend</button>
            <button onclick="addText('beforeend')">insertAdjacentText</button>
        </div>

        <div id="container2" class="container">
            <div class="target item">기준 아이템(Target)</div>
        </div>

        <script>
            const target2 = document.querySelector("#container2 .target");

            function addHTML(position) {
                target2.insertAdjacentHTML(position, `<div class="item" ">
        HTML(${position})
      </div>`);
            }

            function addText(position) {
                target2.insertAdjacentText(position, "<b>Text 그대로</b>");
            }
        </script>

    </section>

    <section>
        <h2>6. 대량 삽입 최적화</h2>
        <ul>
            <li><code>node.cloneNode(true)</code> : 노드 복제 (true = 자식 포함)</li>
            <li><code>DocumentFragment</code> : 여러 노드를 임시로 모아 한 번에 삽입 → 성능 최적화</li>
        </ul>
    </section>
    <section>
        <h2>7.요소 노드 복제 (cloneNode)</h2>
        <ul>
            <li><code>node.cloneNode(deep)</code> : 현재 노드를 복제</li>
            <li><code>deep</code> 매개변수
                <ul>
                    <li><code>false</code> (기본값) → 요소 노드 자체만 복제 (자식 노드 없음)</li>
                    <li><code>true</code> → 요소와 그 안의 모든 자식 노드까지 전체 복제</li>
                </ul>
            </li>
            <li>복제된 노드는 화면에 보이지 않으며, 반드시 <code>append()</code>, <code>before()</code> 등으로 문서에 삽입해야 함</li>
            <li>복제 시 <strong>이벤트 핸들러는 복제되지 않음</strong> (다시 등록 필요)</li>
            <li>활용 예시
                <ul>
                    <li>템플릿 형태의 요소를 복제하여 여러 개의 일정/게시글을 만들 때 사용</li>
                    <li>같은 모양의 버튼, 카드 등을 반복적으로 찍어낼 때 효율적</li>
                </ul>
            </li>
        </ul>
    </section>

    <style>
        body { font-family: system-ui, sans-serif; line-height: 1.5; }
        .wrap { max-width: 720px; margin: 24px auto; }
        .toolbar { display: flex; gap: 8px; flex-wrap: wrap; }
        .list { border: 2px solid #333; border-radius: 8px; padding: 12px; margin-top: 12px; }
        .item { padding: 8px 10px; border-radius: 6px; background: #f2f6ff; margin: 6px 0; display: flex; justify-content: space-between; align-items: center; }
        .meta { font-size: 0.9em; color: #555; }
        .badge { font-size: 0.8em; padding: 2px 6px; border-radius: 999px; background: #dde5ff; margin-left: 6px; }
        .danger { background: #ffeaea; }
        .target { background: #e9ffe9; }
        .muted { color: #777; font-size: 0.9em; }
        form input { padding: 6px 8px; }
        form button { padding: 6px 10px; }
    </style>
    <div class="wrap">
        <h1>일정 앱 과제 (노드 추가/삽입 중심)</h1>

        <!-- 입력 폼 -->
        <form id="scheduleForm" class="toolbar">
            <input name="titleInput" type="text" placeholder="제목" />
            <input name="dateInput" type="datetime-local" />
            <input name="placeInput" type="text" placeholder="장소(옵션)" />
            <p>
                <button id="addAppend" type="submit">1.append로 추가</button>
                <button id="addPrepend" type="button">2.prepend로 추가</button>
                <button id="addBefore" type="button">3.before로 추가</button>
                <button id="addAfter" type="button">4.after로 추가</button>
            </p>
        </form>

        <!-- 안내 -->
        <p class="muted">아래 문제 지시에 따라 스크립트를 작성하세요. innerHTML 남용 금지(문제에서 허용하는 경우만 사용).</p>
        <style>
            .d-none{
                display: none;
            }
        </style>

        <div class="item d-none" id="itemEx" >
            <div>
                <strong class="title"></strong>
                <div class="meta">
                    <span class="time"></span> ·
                    <span class="place"></span>
                </div>
            </div>
            <button class="btnRemove">삭제</button>
        </div>

        <!-- 일정 리스트 -->
        <section class="list" id="scheduleList">
            <div class="item target" id="anchorItem">
                <div>
                    <strong>팀 회의</strong>
                    <span class="badge">기준(anchor)</span>
                    <div class="meta">2025-09-10 10:00 · 회의실 A</div>
                </div>
                <button class="btnRemove">삭제</button>
            </div>
            <div class="item">
                <div>
                    <strong>리뷰 준비</strong>
                    <div class="meta">2025-09-12 14:00 · 온라인</div>
                </div>
                <button class="btnRemove">삭제</button>
            </div>
        </section>
        <script>
            const scheduleForm = document.querySelector('#scheduleForm');//스케줄등록폼
            // const addAppend=document.querySelector('#addAppend');//스케줄을 마지막에 등록버튼
            const addPrepend=document.querySelector('#addPrepend');//맨앞 등록버튼
            const addBefore=document.querySelector('#addBefore');//특정 일정 앞 등록버튼
            const addAfter=document.querySelector('#addAfter');//특정 일정 뒤 등록버튼
            const scheduleList=document.querySelector('#scheduleList'); //일정 리스트

            scheduleForm.addEventListener('submit',function (e){
                e.preventDefault();
                //scheduleForm==e.target(currentTarget)==this
                let title=this.titleInput.value;
                let date=this.dateInput.value.replace("T"," ");
                let place=this.placeInput.value;
                console.log(title,date,place);
                //null , "" ,NaN,0 => false
                if(!(title && date && place )){ //요효성검사
                    alert("일정, 날짜, 장소 모두 입력해야합니다.");
                    return; //함수종료
                }
                //1.html 문자열 => insertAdjacentHTML
                let html=`
            <div class="item">
                <div>
                    <strong>${title}</strong>
                    <div class="meta">${date} · ${place}</div>
                </div>
                <button class="btnRemove">삭제</button>
            </div>
`;
                scheduleList.insertAdjacentHTML("beforeend", html);
            });
            addPrepend.addEventListener('click',function (e){
                //button click : e.target====this===addPrepend
                //(e.target.form) : button을 포함하는 폼
                let title=e.target.form.titleInput.value;
                let date=e.target.form.dateInput.value.replace("T"," ");
                let place=e.target.form.placeInput.value;
                let divItem=createItemNode(title,date,place);
                scheduleList.prepend(divItem);
            });
            addBefore.addEventListener('click',function (e){
                let anchorItem=document.querySelector('#anchorItem');
                let title=this.form.titleInput.value;
                let date=this.form.dateInput.value.replace("T"," ");
                let place=this.form.placeInput.value;
                console.log(title,date,place);
                let divItem=createItemNode(title,date,place);
                anchorItem.before(divItem);

            })


            /*<div class="item">
            <div>
                <strong>${title}</strong>
                <div class="meta">${date} · ${place}</div>
            </div>
            <button class="btnRemove">삭제</button>
        </div> 해당 노드개체를 만들어서 반환하는 함수 */
            function createItemNode(title,date,place){
                let divItem=document.createElement("div");
                divItem.className= "item";
                let div=document.createElement("div");
                let buttonRemove=document.createElement("button");
                buttonRemove.className= "btnRemove";
                buttonRemove.append("삭제");
                divItem.append(div,buttonRemove);
                let strong=document.createElement("strong");
                let divMeta=document.createElement("div");
                divMeta.className= "meta";
                strong.append(title);
                divMeta.append(`${date} · ${place}`);
                div.append(strong,divMeta);
                return divItem;
            }
            const itemEx=document.querySelector('#itemEx');

            const itemCopy=function (title,time,place){
                const item=itemEx.cloneNode(true);
                item.removeAttribute("id");
                item.classList.remove("d-none")
                const titleNode=item.querySelector('.title');
                const timeNode=item.querySelector('.time');
                const placeNode=item.querySelector('.place');
                titleNode.append(title);
                timeNode.append(time);
                placeNode.append(place);
                return item;
            }

            addAfter.addEventListener('click',function (e){
                const anchorItem=document.querySelector('#anchorItem');
                let title=this.form.titleInput.value;
                let time=this.form.dateInput.value.replace("T"," ");
                let place=this.form.placeInput.value;
                anchorItem.after(itemCopy(title,time,place));
            });






        </script>
        <hr />

        <section>
            <h2>노드 추가/삽입 과제 </h2>
            <ul>
                <li>
                    문제 1. 폼의 입력값(제목/일시)을 이용해 새 일정 요소를 만들어
                    <code>#scheduleList</code>에 <strong>append()</strong> 하시오.
                </li>
                <li>
                    문제 2. 같은 입력값으로 새 일정을 <strong>prepend()</strong> 하시오.
                    (리스트 맨 앞에 추가)
                </li>
                <li>
                    문제 3. 기준 일정(<code>#anchorItem</code>) 바로 앞에
                    “공지: 내일 오전 9시 전사 공지”라는 일정을 <strong>before()</strong> 로 삽입하시오.
                </li>
                <li>
                    문제 4. 기준 일정(<code>#anchorItem</code>) 바로 뒤에
                    “안내: 회의 끝나고 점심”이라는 일정을 <strong>after()</strong> 로 삽입하시오.
                </li>
                <li>
                    문제 5. 각 일정의 “삭제” 버튼을 누르면 해당 일정이
                    <strong>remove()</strong> 로 삭제되게 하시오.
                </li>
            </ul>
        </section>
        <!-- 스크립트 영역: 여기에 작성 -->
        <script>
            // 여기에 각 문제의 해답 코드를 작성하세요.
            // 예시) document.querySelector('#addAppend').addEventListener('click', () => { ... })
        </script>
    </div>
</body>
</html>