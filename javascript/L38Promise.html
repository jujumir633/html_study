<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>비동기함수를 동기화하는 Promise</title>
</head>
<body>
    <h1>비동기함수를 동기화하는 Promise</h1>
    <script>
        //통신 == setTimeout
        let a=10;
        setTimeout(()=>{
            a+=10;
            setTimeout(()=>{
                a+=10;
                setTimeout(()=>{
                    a+=10;
                    console.log(a)
                })
            })
        },0);
        //비동기함수에서 실행을 동기화하는 일반적인 방법
        //=> 콜백지옥을 유발함
        console.log(a)

        let n=10;
        new Promise((resolve)=>{
            setTimeout(()=>{
                n+=10;
                resolve(); //Promise 의 체이닝한 then의 콜백함수를 실행
            },0)
        }).then(()=>{
          return new Promise((resolve)=>{
              setTimeout(()=>{
                  n+=10;
                  resolve()
              },0)
          });
        }).then(()=>{
            n+=10;
            console.log("n:",n)
        })
        //프라미스화 : 함수를 실행하면 프라미스 객체를 반환
        //setTimeoutPromise() === new Promise()
        function setTimeoutPromise(func,ms=0){
            return new Promise((resolve)=>{
                setTimeout(()=>{
                    func();
                    resolve();
                },ms);
            })
        }
        let b=10;
        setTimeoutPromise(()=>{
            b+=10;
        },1000).then(()=>{
            return setTimeoutPromise(()=>{
                b+=10;
            },1000)
        }).then(()=>{
            return setTimeoutPromise(()=>{
                b+=10;
            },1000)
        }).then(()=>{
            console.log("b:",b)
        })

        //async 함수 promise 로 작성된 함수를 await로 동기화
        let c=10;
        async function cIncrement(){
            await setTimeoutPromise(()=>{c+=10},1000);
            await setTimeoutPromise(()=>{c+=10},1000);
            await setTimeoutPromise(()=>{c+=10},1000);
            await setTimeoutPromise(()=>{c+=10},1000);
            await setTimeoutPromise(()=>{c+=10},1000);
            console.log("c:",c);
        }
        cIncrement()




    </script>
</body>
</html>